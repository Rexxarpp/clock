C51 COMPILER V9.60.0.0   DISPLAY                                                           11/29/2020 10:45:41 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DISPLAY
OBJECT MODULE PLACED IN .\Objects\display.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE display.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\d
                    -isplay.lst) OBJECT(.\Objects\display.obj)

line level    source

   1          #include "display.h"
   2          #include "hc595.h"
   3          #include "delay.h"
   4          
   5          
   6          //hc505 控制2803 NPN型达林顿管驱动 共阳极数码管 高电平选中
   7          //数码管段码与595引脚关系如下：
   8          //段码----595引脚---字节中的位置
   9          // A----------------QC---------3
  10          // B----------------QD---------4
  11          // C----------------QG---------7
  12          // D----------------QF---------6
  13          // E----------------QE---------5
  14          // F----------------QB---------2
  15          // G----------------QA---------1
  16          //时钟冒号----------QH---------8
  17          
  18          //数码管段码位置如下
  19          //    ===A====
  20          //    =      =
  21          //    =F     =B
  22          //    =      =
  23          //    ===G====
  24          //    =      =
  25          //    =E     =C
  26          //    =      =
  27          //    ===D====  DP
  28          
  29          unsigned char code seg_code[] = 
  30                  {0x7E, 0x48, 0x3D, 0x6D, 0x4B, 0x67, 0x77, 0x4C, 0x7F, 0x6F,  0x5F, 0x73, 0x36, 0x79, 0x37, 0x17, //0,1,2
             -,3,4,5,6,7,8,9,A,b,C,d,E,F
  31               0xFE, 0xC8, 0xBD, 0xED, 0xCB, 0xE7, 0xF7, 0xCC, 0xFF, 0xEF,  0xDF, 0xF3, 0xB6, 0xF9, 0xB7, 0x97};//带
             -时钟冒号的0～9
  32          
  33          //位选与595引脚对应关系
  34          //位选-----595引脚---字节中的位置
  35          //   S1------QG---------7
  36          //   S2------QF---------6
  37          //   S3------QE---------5
  38          //   S4------QD---------4
  39          //低电平为选中
  40          unsigned char code place_code[] = {0xBF, 0xDF, 0xEF, 0xF7};//S1, S2, S3, S4 时钟冒号的位选与S2相同
  41          
  42          unsigned char displayBuf[] = {1, 2, 4, 5};
  43          
  44          //参数not_display_place表示不显示的位，传0、1、2、3分别不显示1、2、3、4位。如果全部显示，传4好了
  45          void display(unsigned char not_display_place)
  46          {
  47   1              //1、送位选
  48   1              //2、送段码
  49   1              //3、延时
  50   1              //4、消隐：将所有段位关闭
  51   1              static unsigned char i = 0;
  52   1              if(i != not_display_place)
C51 COMPILER V9.60.0.0   DISPLAY                                                           11/29/2020 10:45:41 PAGE 2   

  53   1              {
  54   2                      hc_595_write_two_byte(0x00, 0xff);//4、消隐：将所有段位关闭 先做消隐，再显示。这样字符显示的时间长，亮度
             -高
  55   2                      hc_595_write_two_byte(seg_code[displayBuf[i]], place_code[i]);//高位是段码，低位是位码 单片机直连位选595
  56   2              }
  57   1              else
  58   1              {
  59   2                      hc_595_write_two_byte(0x00, 0xff);//4、消隐：将所有段位关闭 先做消隐，再显示。这样字符显示的时间长，亮度
             -高
  60   2                      hc_595_write_two_byte(seg_code[displayBuf[i]], 0xff);//高位是段码，低位是位码 单片机直连位选595
  61   2              }
  62   1      
  63   1              i++;
  64   1              i = i%4;
  65   1      //      delay_xms(1);//定时器中调用不用延时
  66   1      
  67   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     59    ----
   CONSTANT SIZE    =     36    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
